using System;
using System.Reflection;
using System.Runtime.InteropServices;

using static OpenGL.Constants;

namespace OpenGL;

public static unsafe class Methods 
{
	public static nint GetMethodAddress(string name) 
	{
		if (name == null)
			throw new ArgumentNullException();

		[DllImport("opengl32", CharSet = CharSet.Ansi)]
		static extern nint wglGetProcAddress(string name);

		nint pointer = wglGetProcAddress(name);
		return (pointer != nint.Zero) ? pointer : throw new MethodAccessException($"Method '{name}' was not found.");
	}

	/*
	// TEMPLATE
	public static readonly AAAAADelegate AAAAA = Marshal.GetDelegateForFunctionPointer<AAAAADelegate>(GetMethodAddress("AAAAA"));
	public delegate CC AAAAADelegate(Aa aa, Bb bb);
	*/


	public static readonly glBindBufferDelegate glBindBuffer = Marshal.GetDelegateForFunctionPointer<glBindBufferDelegate>(GetMethodAddress("glBindBuffer"));
	public delegate void glBindBufferDelegate(BufferType target, uint buffer);

	public static readonly glBufferDataDelegate glBufferData = Marshal.GetDelegateForFunctionPointer<glBufferDataDelegate>(GetMethodAddress("glBufferData"));
	public delegate void glBufferDataDelegate(BufferType target, nint size, nint data, BufferUsage usage);

	internal static readonly glDebugMessageCallbackDelegate glDebugMessageCallback = Marshal.GetDelegateForFunctionPointer<glDebugMessageCallbackDelegate>(GetMethodAddress("glDebugMessageCallback"));
	internal delegate void glDebugMessageCallbackDelegate(ErrorCallback callback, nint userParam);

	public static readonly glDrawElementsDelegate glDrawElements = Marshal.GetDelegateForFunctionPointer<glDrawElementsDelegate>(GetMethodAddress("glDrawElements"));
	public delegate void glDrawElementsDelegate(uint mode, int count, uint type, nint indices);

	[DllImport("opengl32")] public static extern uint glGetError();

	public static readonly glGenBuffersDelegate glGenBuffers = Marshal.GetDelegateForFunctionPointer<glGenBuffersDelegate>(GetMethodAddress("glGenBuffers"));
	public delegate void glGenBuffersDelegate(int n, ref uint buffers);

	public static readonly glVertexAttribPointerDelegate glVertexAttribPointer = Marshal.GetDelegateForFunctionPointer<glVertexAttribPointerDelegate>(GetMethodAddress("glVertexAttribPointer"));
	public delegate void glVertexAttribPointerDelegate(uint index, int size, uint type, bool normalized, int stride, nint pointer);
}

/*
glActiveShaderProgram
glActiveTexture
glAttachShader
glBeginConditionalRender
glBeginQuery
glBeginQueryIndexed
glBeginTransformFeedback
glBindAttribLocation
glBindBuffer
glBindBufferBase
glBindBufferRange
glBindBuffersBase
glBindBuffersRange
glBindFragDataLocation
glBindFragDataLocationIndexed
glBindFramebuffer
glBindImageTexture
glBindImageTextures
glBindProgramPipeline
glBindRenderbuffer
glBindSampler
glBindSamplers
glBindTexture
glBindTextureUnit
glBindTextures
glBindTransformFeedback
glBindVertexArray
glBindVertexBuffer
glBindVertexBuffers
glBlendColor
glBlendEquation
glBlendEquationSeparate
glBlendFunc
glBlendFuncSeparate
glBlitFramebuffer
glBufferData
glBufferStorage
glBufferSubData
glCheckFramebufferStatus
glClampColor
glClear
glClearBuffer
glClearBufferData
glClearBufferSubData
glClearColor
glClearDepth
glClearStencil
glClearTexImage
glClearTexSubImage
glClientWaitSync
glClipControl
glColorMask
glCompileShader
glCompressedTexImage1D
glCompressedTexImage2D
glCompressedTexImage3D
glCompressedTexSubImage1D
glCompressedTexSubImage2D
glCompressedTexSubImage3D
glCopyBufferSubData
glCopyImageSubData
glCopyTexImage1D
glCopyTexImage2D
glCopyTexSubImage1D
glCopyTexSubImage2D
glCopyTexSubImage3D
glCreateBuffers
glCreateFramebuffers
glCreateProgram
glCreateProgramPipelines
glCreateQueries
glCreateRenderbuffers
glCreateSamplers
glCreateShader
glCreateShaderProgram
glCreateTextures
glCreateTransformFeedbacks
glCreateVertexArrays
glCullFace
glDebugMessageCallback
glDebugMessageControl
glDebugMessageInsert
glDeleteBuffers
glDeleteFramebuffers
glDeleteProgram
glDeleteProgramPipelines
glDeleteQueries
glDeleteRenderbuffers
glDeleteSamplers
glDeleteShader
glDeleteSync
glDeleteTextures
glDeleteTransformFeedbacks
glDeleteVertexArrays
glDepthFunc
glDepthMask
glDepthRange
glDepthRangeArray
glDepthRangeIndexed
glDetachShader
glDisableVertexAttribArray
glDispatchCompute
glDispatchComputeIndirect
glDrawArrays
glDrawArraysIndirect
glDrawArraysInstanced
glDrawArraysInstancedBaseInstance
glDrawBuffer
glDrawBuffers
glDrawElements
glDrawElementsBaseVertex
glDrawElementsIndirect
glDrawElementsInstanced
glDrawElementsInstancedBaseInstance
glDrawElementsInstancedBaseVertex
glDrawElementsInstancedBaseVertexBaseInstance
glDrawRangeElements
glDrawRangeElementsBaseVertex
glDrawTransformFeedback
glDrawTransformFeedbackInstanced
glDrawTransformFeedbackStream
glDrawTransformFeedbackStreamInstanced
glEnable
glEnableVertexAttribArray
glEndConditionalRender
glEndQuery
glEndQueryIndexed
glEndTransformFeedback
glFenceSync
glFinish
glFlush
glFlushMappedBufferRange
glFramebufferParameteri
glFramebufferRenderbuffer
glFramebufferTexture
glFramebufferTextureLayer
glFrontFace
glGenBuffers
glGenFramebuffers
glGenProgramPipelines
glGenQueries
glGenRenderbuffers
glGenSamplers
glGenTextures
glGenTransformFeedbacks
glGenVertexArrays
glGenerateMipmap
glGet
glGetActiveAtomicCounterBufferiv
glGetActiveAttrib
glGetActiveSubroutineName
glGetActiveSubroutineUniform
glGetActiveSubroutineUniformName
glGetActiveUniform
glGetActiveUniformBlock
glGetActiveUniformBlockName
glGetActiveUniformName
glGetActiveUniformsiv
glGetAttachedShaders
glGetAttribLocation
glGetBufferParameter
glGetBufferPointerv
glGetBufferSubData
glGetCompressedTexImage
glGetCompressedTextureSubImage
glGetDebugMessageLog
glGetError
glGetFragDataIndex
glGetFragDataLocation
glGetFramebufferAttachmentParameter
glGetFramebufferParameter
glGetGraphicsResetStatus
glGetInternalformat
glGetMultisample
glGetObjectLabel
glGetObjectPtrLabel
glGetPointerv
glGetProgram
glGetProgramBinary
glGetProgramInfoLog
glGetProgramInterface
glGetProgramPipeline
glGetProgramPipelineInfoLog
glGetProgramResource
glGetProgramResourceIndex
glGetProgramResourceLocation
glGetProgramResourceLocationIndex
glGetProgramResourceName
glGetProgramStage
glGetQueryIndexed
glGetQueryObject
glGetQueryiv
glGetRenderbufferParameter
glGetSamplerParameter
glGetShader
glGetShaderInfoLog
glGetShaderPrecisionFormat
glGetShaderSource
glGetString
glGetSubroutineIndex
glGetSubroutineUniformLocation
glGetSync
glGetTexImage
glGetTexLevelParameter
glGetTexParameter
glGetTextureSubImage
glGetTransformFeedback
glGetTransformFeedbackVarying
glGetUniform
glGetUniformBlockIndex
glGetUniformIndices
glGetUniformLocation
glGetUniformSubroutine
glGetVertexArrayIndexed
glGetVertexArrayiv
glGetVertexAttrib
glGetVertexAttribPointerv
glHint
glInvalidateBufferData
glInvalidateBufferSubData
glInvalidateFramebuffer
glInvalidateSubFramebuffer
glInvalidateTexImage
glInvalidateTexSubImage
glIsBuffer
glIsEnabled
glIsFramebuffer
glIsProgram
glIsProgramPipeline
glIsQuery
glIsRenderbuffer
glIsSampler
glIsShader
glIsSync
glIsTexture
glIsTransformFeedback
glIsVertexArray
glLineWidth
glLinkProgram
glLogicOp
glMapBuffer
glMapBufferRange
glMemoryBarrier
glMinSampleShading
glMultiDrawArrays
glMultiDrawArraysIndirect
glMultiDrawElements
glMultiDrawElementsBaseVertex
glMultiDrawElementsIndirect
glObjectLabel
glObjectPtrLabel
glPatchParameter
glPauseTransformFeedback
glPixelStore
glPointParameter
glPointSize
glPolygonMode
glPolygonOffset
glPopDebugGroup
glPrimitiveRestartIndex
glProgramBinary
glProgramParameter
glProgramUniform
glProvokingVertex
glPushDebugGroup
glQueryCounter
glReadBuffer
glReadPixels
glReleaseShaderCompiler
glRenderbufferStorage
glRenderbufferStorageMultisample
glResumeTransformFeedback
glSampleCoverage
glSampleMaski
glSamplerParameter
glScissor
glScissorArray
glScissorIndexed
glShaderBinary
glShaderSource
glShaderStorageBlockBinding
glStencilFunc
glStencilFuncSeparate
glStencilMask
glStencilMaskSeparate
glStencilOp
glStencilOpSeparate
glTexBuffer
glTexBufferRange
glTexImage1D
glTexImage2D
glTexImage2DMultisample
glTexImage3D
glTexImage3DMultisample
glTexParameter
glTexStorage1D
glTexStorage2D
glTexStorage2DMultisample
glTexStorage3D
glTexStorage3DMultisample
glTexSubImage1D
glTexSubImage2D
glTexSubImage3D
glTextureBarrier
glTextureView
glTransformFeedbackBufferBase
glTransformFeedbackBufferRange
glTransformFeedbackVaryings
glUniform
glUniformBlockBinding
glUniformSubroutines
glUnmapBuffer
glUseProgram
glUseProgramStages
glValidateProgram
glValidateProgramPipeline
glVertexArrayElementBuffer
glVertexAttrib
glVertexAttribBinding
glVertexAttribDivisor
glVertexAttribFormat
glVertexAttribPointer
glVertexBindingDivisor
glViewport
glViewportArray
glViewportIndexed
glWaitSync
*/
